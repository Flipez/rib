#!/usr/bin/ruby
# coding: utf-8
#
# Ruby IRC bot
#
# This program is free software. It comes without any warranty, to
# the extent permitted by applicable law. You can redistribute it
# and/or modify it under the terms of the Do What The Fuck You Want
# To Public License, Version 2, as published by Sam Hocevar. See
# http://sam.zoy.org/wtfpl/COPYING for more details. 

# add local library directory to $LOAD_PATH
$: << File.realpath('lib')

require 'rib/rib'

rib = RIB::Bot.new do |bot|

  bot.protocol = :irc               # which protcoll to use? :irc or :xmpp
  bot.server = 'irc.quakenet.org'   # IRC/XMPP-Server to join
  bot.port = 6667
  #bot.ssl.use = false              # use ssl?
  #bot.ssl.verify = false           # verify ssl connection?
  #bot.ssl.ca_path = '/etc/ssl/certs' # ca path to use
  #bot.ssl.client_cert = ''         # host certificate
  #bot.nick = 'rib'
  bot.channel = '#rib'
  #bot.jid = 'rubybot@xmpp.example.com'  # XMPP: jid of user to login as
  # Authentification command for IRC or password for the XMPP user
  #bot.auth = 'Q@CServe.quakenet.org auth rubybot sEcReTpAsSwOrD'
  bot.tc = '!'                # Character which triggers the bot to do something
  bot.password = 'rib'              # password for interacting with the bot 
  bot.qmsg = 'See you later, shitlords!'    # Message when bot leaves
  bot.linkdump = './yaylinks'
  bot.dumplink = 'https://www.linkdumpiorrrr.de'
  bot.helplink = 'https://github.com/aibor/rib'
  bot.title = true                  # Print HTML-title of a posted url if set.
  #bot.pony = false                 # Appreciate ponies
  bot.verbose = false                # Debuging time
  bot.admin = 'aibo'

end

eval(IO.read('actions.rb'), binding)

rib.add_response /\A#{rib.tc}reload\s#{rib.password}/ do |m,u,c|
  return "nope" unless u == rib.admin
  eval(IO.read('actions.rb'), binding) ? "geschafft" : "kaputt"
end

rib.run
